---
description: >
  Discover how to use uv to manage project dependencies and build Python
  packages, streamlining the process of creating production-ready artifacts.
---

# üöÄ 1.3. uv (project)

## üì¶ What is a package?

A [Python package](https://packaging.python.org/en/latest/) is a collection of
Python modules that can be installed and used in your projects. Packages allow
you to leverage external libraries and frameworks, extending Python's built-in
capabilities.

[uv](https://docs.astral.sh/uv/) simplifies the management of these packages by
treating them as dependencies. With uv, you can declare the packages your
project needs in a `pyproject.toml` file. uv then ensures that the correct
versions of these dependencies are installed, creating a stable and
conflict-free development environment. Here‚Äôs a basic example of how to specify
dependencies with uv:

```toml
# https://docs.astral.sh/uv/reference/pyproject-toml/

[project]
name = "example-project"
version = "0.1.0"
description = "An example project to demonstrate uv"
dependencies = [
    "requests>=2.32.3",
]

[project.optional-dependencies]
dev = [
    "pytest>=8.3.4",
]
```

You will learn more on how to construct and publish Python Package in the
[Package section of this course](../3. Productionizing/3.0. Package.md).

## ü§î Why do you need a package manager?

In the Python ecosystem, software is typically distributed and installed as
packages. These packages, often in Wheel or zip format, contain source code and
essential metadata. Manually managing these packages and their dependencies can
be a tedious and error-prone process. Package managers like uv automate these
tasks, which boosts productivity and ensures that your development and
deployment environments are consistent.

<figure markdown="span">
  <img src="https://imgs.xkcd.com/comics/python_environment_2x.png" alt="A comic showing a person trying to set up a Python environment and getting frustrated with the complexity of the process." width="500" />
  <figcaption>
    Python Environment Comic (<a href="https://xkcd.com/1987/">source</a>)
  </figcaption>
</figure>

By default, uv will download and install Python packages from
[PyPI](https://pypi.org/), a repository of software for the Python programming
language. If needed,
[other Python repositories](https://warehouse.pypa.io/repository-projects/) can
be configured to provide extra sources of dependencies.

## ‚ú® Why should you use uv in your project?

Using uv in your project offers several key benefits:

- **Improved Environment Management**: uv simplifies the management of project
  environments, which helps maintain consistency.
- **Simplified Package Building and Distribution**: It provides a unified
  workflow for building, distributing, and installing packages, which reduces
  complexity.
- **Standardized Project Metadata**: uv uses a standard `pyproject.toml` file to
  define project metadata, such as dependencies, authors, and versioning. This
  ensures that your project is easy to understand and maintain.

Compared to traditional tools like pip and venv, uv provides a more cohesive and
user-friendly experience by combining package and environment management into a
single, streamlined process.

## üõ†Ô∏è How can you use uv for your MLOps project?

To integrate uv into your MLOps project, you can follow these steps to set up
your development environment:

- Begin by creating a new project directory and navigate into it.
- Run `uv init` in your terminal. This command starts an interactive guide to
  help set initial project parameters, such as package name, version,
  description, author, and dependencies. This step generates a `pyproject.toml`
  file, crucial for your project's configuration under uv.
- Run `uv sync` to install the project dependencies and source code. This will
  let you access your project code through `uv run` and its command-line
  utilities.

The `pyproject.toml` file is central to defining your project's dependencies and
settings. Let's break down a typical example:

```toml
# https://docs.astral.sh/uv/reference/settings/
# https://packaging.python.org/en/latest/guides/writing-pyproject-toml/

# Project metadata
[project]
name = "bikes"
version = "4.1.0"
description = "Predict the number of bikes available."
authors = [{ name = "M√©d√©ric HURIER", email = "github@fmind.dev" }]
readme = "README.md"
license = { file = "LICENSE.txt" }
keywords = ["mlops", "python", "package"]
requires-python = ">=3.13"

# Main dependencies
dependencies = [
    "loguru>=0.7.3",
    "matplotlib>=3.10.1",
    "mlflow>=2.20.3",
    "scikit-learn>=1.6.1",
    # ... and so on
]

# Project URLs
[project.urls]
Homepage = "https://github.com/fmind/mlops-python-package"
Documentation = "https://fmind.github.io/mlops-python-package/bikes.html"
Repository = "https://github.com/fmind/mlops-python-package"

# Command-line scripts
[project.scripts]
bikes = 'bikes.scripts:main'

# Build system configuration
[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"
```

Here‚Äôs what each section means:

- **`[project]`**: This section contains general metadata about your project,
  such as its name, version, and description.
- **`dependencies`**: This is a list of the main dependencies that your project
  needs to run.
- **`[project.urls]`**: This section allows you to include helpful links, such
  as to the project's homepage or documentation.
- **`[project.scripts]`**: Here, you can define command-line scripts that will
  be created when your package is installed.
- **`[build-system]`**: This section specifies the build tool that `uv` will use
  to create your package.

At the end of the installation process, a `uv.lock` file is generated with all
the project dependencies that have been installed. You can remove and regenerate
the `uv.lock` file if you wish to update the list of dependencies.

## ‚ûï How can you install dependencies for your project with uv?

uv distinguishes between main (production) and development dependencies, which
allows for a more organized approach to dependency management. To add
dependencies, you can use the following commands:

```bash
# For main dependencies
$ uv add pandas scikit-learn

# For development dependencies
$ uv add --group dev ipykernel
```

Executing these commands updates the `pyproject.toml` file, accurately managing
and versioning your project's dependencies.

## Main vs. Dev Dependencies in uv

In uv, dependencies are categorized into two types:
[main dependencies](https://docs.astral.sh/uv/concepts/projects/dependencies/#project-dependencies)
and
[development (dev) dependencies](https://docs.astral.sh/uv/concepts/projects/dependencies/#development-dependencies).

- **Main Dependencies**: These are essential for your project to run in a
  production environment. For example, libraries like pandas or scikit-learn are
  typically main dependencies in an MLOps project.

- **Development Dependencies**: These are only used for development and testing
  purposes. Examples include testing frameworks like `pytest` or linters like
  `ruff`. They are not required for the application to run in production.

Here‚Äôs a simple example in a `pyproject.toml` file:

```toml
[project]
dependencies = [
    "flask>=3.1.0",  # Main dependency
]

[project.optional-dependencies]
dev = [
    "pytest>=8.3.4",  # Development dependency
]
```

This setup helps keep production environments lean by excluding unnecessary
development tools.

## üè¢ Using Custom Repositories

uv supports
[custom package repositories](https://docs.astral.sh/uv/concepts/projects/dependencies/#dependency-sources),
including private and organizational ones. This allows you to use proprietary
packages alongside those from the public PyPI. You can easily add a custom
repository and configure authentication using uv's commands, which ensures
secure and flexible dependency management.

## ‚ö° Common `uv` Commands

Here is a quick reference for some of the most common `uv` commands:

- **`uv init`**: Initializes a new project by creating a `pyproject.toml` file.
- **`uv add`**: Adds a new dependency to your project.
- **`uv sync`**: Installs the dependencies listed in your `pyproject.toml` file.
- **`uv run`**: Executes a command in the project's virtual environment.

## üîí The `uv.lock` File

The `uv.lock` file is generated after you install your project's dependencies.
It records the exact versions of all the packages that were installed, including
their dependencies. This is crucial for ensuring that your project is
reproducible. When you share your project with others, they can use the
`uv.lock` file to create an identical environment, which helps to avoid bugs and
inconsistencies.

## üîë Key Takeaways

- **Unified Tool**: `uv` streamlines Python project management by combining the
  functionalities of `pip`, `venv`, `pipx`, and `pyenv` into a single, fast tool.
- **`pyproject.toml`**: This file is central to `uv` projects, defining
  metadata, dependencies (main and development), and build configurations.
- **Dependency Management**: `uv` simplifies adding, managing, and synchronizing
  project dependencies, ensuring consistent environments.
- **Reproducibility**: The `uv.lock` file guarantees reproducible environments
  by locking exact dependency versions.

## üìö Additional Resources

- **[`pyproject.toml` example from the MLOps Python Package](https://github.com/fmind/mlops-python-package/blob/main/pyproject.toml)**
- [uv: Unified Python packaging](https://astral.sh/blog/uv-unified-python-packaging)
